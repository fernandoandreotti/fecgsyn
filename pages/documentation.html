---
layout: default
title: Documentation
author:  "Fernando Andreotti"
priority: 5
---

<p>Several routines are available with the <em>FECGSYN</em> toolbox. On this page you can find a general overview on the algorithms available.. For detailed information on each function, please refer to the <a href="{{site.github.url}}/pages/headers.html">header's page</a>.</p>

<p><em>FECGSYN</em> is an open-source toolbox. If you wish to include your methods on this toolbox,<a href="{{site.github.url}}/pages/contribute.html" data-toggle="tooltip" title="Hooray!"> see how to contribute</a>.</p>

<section class="bs-docs-section"> 
<h1 id="Simulator">Simulating cardiac signals</h1><br>

<p><em>FECGSYN</em> is a realistic non-invasive foetal ECG (NI-FECG) generator that uses the Gaussian ECG model originally introduced by McSharry et al (2003). The toolbox generates synthetic  NI-FECG mixtures considering various user-defined settings, e.g. noise sources, heart rate and heart rate variability, rotation of the maternal and foetal heart axes due to respiration, foetus movement, contractions, ectopic beats and multiple pregnancy. Any number of electrodes can be freely placed on the maternal abdomen. The synthetic ECG simulator is a good tool for modelling realistic feto-maternal mixtures and specific events such as abrupt heart rate increase, in order to benchmark signal processing algorithms on realistic  data and for scenarios that resemble important clinical events. The <em>FECGSYN</em> is capable of simulating adult and non-invasive fetal ECG realistic simulations. Some of the features present are listed below:</p>
    
<ul>
<li>Realistic noise sources included (i.e. muscular artifact, baseline wander and electrode motion)</li>
<li>
Different VCG models from different individuals are availabe, including ectopic cases.    
</li>    
<li>Each source, i.e. either cardiac (e.g. mother, fetus) or noise, is regarded as an individual punctual dipoles with different magnitudes and spatial positions, allowing multiple fetuses and any number of noise sources distributed through the volume conductor;</li>    
<li>
Translatory and rotatory motion of dipole sources is implemented. This improvement allow the modelling of fetal/maternal respiratory movements and fetal/noise movements inside the volume conductor; 
</li>    
<li>
Different SNRs were assigned to each source, meaning each fetus/noise could have distinct strengths;    
</li>    
<li>
Both heart rate signals and SNR strengths can be modulated, e.g. by a hyperbolic tangent to increase/decrease \ac{HR} or noises SNR;
</li>
</ul><br>
    
    
<p>When using <em>FECGSYN</em>, please reference to <a href="#Behar2014model">Behar2014model</a>.</p>

<h2 id="back">History</h2>
  
<p><em>FECGSYN</em> is built upon the work from <a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=1186732">McSharry et al.</a> 
and <a href="http://asp.eurasipjournals.com/content/pdf/1687-6180-2007-043407.pdf">Sameni et al.</a>. The original code from McSharry et al. is 
available in MATLAB and in C on PhysioNet (<a href="http://www.physionet.org/physiotools/ecgsyn/"><span class="octicon octicon-globe"></span> ECGSYN</a>). The code developed
by Sameni et al. is part of the OSET toolbox, also available online in MATLAB (<a href="http://oset.ir/"><span class="octicon octicon-globe"></span> OSET</a>).</p>

<p>A summary of the latest modifications is available on the <a href="{{site.github.url}}/pages/changelog">Changelog section</a>. For a detailed list of changes please see the <a href="{{site.github.url}}"><span class="octicon octicon-mark-github"></span> GitHub repository</a>:</p>

<ul>
  <li>McSharry, P. E., & Clifford, G. D. (2003). <a href="http://arxiv.org/pdf/physics/0406017.pdf">Open-Source Software for Generating Electrocardiogram Signals</a>, <em>IEEE Trans. Biomed. Eng.</em>, <b>50(3)</b>:289-294; March 2003. </li>
  <li>Sameni, R., Clifford, G. D., Jutten, C., & Shamsollahi, M. B. (2007). <a href="http://doi.org/10.1155/2007/43407">Multichannel ECG and Noise Modeling: Application to Maternal and Fetal ECG Signals</a>. <em>EURASIP J Adv Signal Process</em>, <b>2007(1)</b>, 043407. </li> 
</ul>



 


</section>

<section class="bs-docs-section"> 
<h1 id="Extraction">Extracting NI-FECG signals</h1><br>
    
<p>The <em>FECGSYN</em> toolbox includes several NI-FECG extraction algorithms. The following methods are currently implemented in the toolbox:</p>
    
<div class="row">
  <div class="col-sm-4"><b>Blind Source Separation</b></div>
  <div class="col-sm-4"><b>Template Subtraction</b></div>
  <div class="col-sm-4"><b>Adaptive Methods</b></div>
</div>
<div class="row">
  <div class="col-sm-4">Independent Component Analysis (ICA)</div>
  <div class="col-sm-4">Single adaptive gain (TSc) <br>(<a href="#Cerutti1986">Cerutti1986</a>)</div>
  <div class="col-sm-4">Least Mean Square (LMS) <br>(<a href="#Widrow1975">Widrow1975</a>)</div>
</div>    
<div class="row">
  <div class="col-sm-4">Principal Component Analysis (PCA)</div>
  <div class="col-sm-4">Adaptive gains for P-QRS-T (TSm) (<a href="#Martens2007">Martens2007</a>)</div>
  <div class="col-sm-4">Root Mean Square (RMS) (<a href="#Behar2014abme">Behar2014abme</a>)</div>
</div>        
<div class="row">
  <div class="col-sm-4"></div>
  <div class="col-sm-4">Linear prediction (TSlp) <br>(<a href="#Ungureanu2007">Ungureanu2007</a>)</div>
  <div class="col-sm-4">Echo State Neural Networks (ESN) (<a href="#Behar2014abme">Behar2014abme</a>)</div>
</div>        
<div class="row">
  <div class="col-sm-4"></div>
  <div class="col-sm-4">TS-PCA (TSpca) <br>(<a href="#Kanjilal997">Kanjilal997</a>)</div>
  <div class="col-sm-4"></div>
</div>        
<div class="row">
  <div class="col-sm-4"></div>
  <div class="col-sm-4">Kalman filtering (TSekf) <br>(<a href="#Sameni2008">Sameni2008</a>)</div>
  <div class="col-sm-4"></div>
</div>         <br>
    
<p></p>    

    
<p>While using FECGSYN toolbox for extracting NI-FECG, please refer to <a href="#Andreotti2016">Andreotti2016</a></p>   
    

<p>The following works were essential for the development of the toolbox:</p>



</section>

<section class="bs-docs-section"> 
<h1 id="Benchmark">Benchmarking algorithms</h1><br>

<p>Along with extraction methods, the toolbox provides tools you can use to benchmark your method's FQRS detection or the morphological feature's accuracy. Benchmarking these methods involve several routines which are briefly listed below: </p>

<div class="row">
  <div class="col-sm-4"><b>FQRS Detection</b></div>
  <div class="col-sm-4"><b>Template Generation</b></div>
  <div class="col-sm-4"><b>FECG Segmentation</b></div>
</div>
<div class="row">
  <div class="col-sm-4">Pan-Tompkins adaptation (<a href="#Behar2014cinc">Behar20014cinc</a>)</div>
  <div class="col-sm-4">Clustering method <br>(<a href="#Oster2015">Oster2015</a>)</div>
  <div class="col-sm-4">ECGPUWAVE <br>(<a href="#Jane1997">Jane1997</a>)</div>
</div>        <br>

    
    
    
<p>While using FECGSYN toolbox for benchmarking purposes, please refer to the following publication: </p>   
    
<div class="panel panel-primary">
<div class="panel-heading"><span class="octicon octicon-book"></span> Reference</div>
<div class="panel-body">      
    Andreotti F., Behar J., Zaunseder S.,Oster J. and Clifford G D., 
<a href="http://iopscience.iop.org/article/10.1088/0967-3334/37/5/627" target="_blank">An Open-Source Framework for Stress-Testing Non-Invasive Foetal ECG Extraction Algorithms.</a> <i>Physiol Meas</i> <b>4</b>, pp. 627-648, 2016.
  </div> </div> <br>
    
    
</section>
<section class="bs-docs-section"> 
<h1 id="Refs">References</h1><br>

The following table refers to algorithms and toolboxes used during the development of the <em>FECGSYN</em>.

<div class="table-responsive">
    <table class="table table-bordered table-striped">
        <thead class="thead-inverse">
        <tr>
          <th style="width: 130px;">Key</th>
          <th>Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><a id="Andreotti2014">Andreotti2014</a></td>
          <td>Andreotti, F., Riedl, M., Himmelsbach, T., Wedekind, D., Wessel, N., Stepan, H., … Zaunseder, S. (2014). <a href="http://iopscience.iop.org/article/10.1088/0967-3334/35/8/1551" data-toggle="tooltip" target="_blank" title="go to article">Robust fetal ECG extraction and detection from abdominal leads.</a> <i>Physiol. Meas.</i>, <b>35(8)</b>, 1551–1567. </td>
        </tr>
         <td><a id="Andreotti2016">Andreotti2016</a></td>
          <td>Andreotti F., Behar J., Zaunseder S.,Oster J. and Clifford G D., 
            <a href="http://iopscience.iop.org/article/10.1088/0967-3334/37/5/627" target="_blank">An Open-Source Framework for Stress    -Testing Non-Invasive Foetal ECG Extraction Algorithms.</a> <i>Physiol Meas</i> <b>5</b>, pp. 627-648, 2016.</td>
        </tr>
        <tr>
          <td><a id="Behar2014abme">Behar2014abme</a></td>
          <td>Behar, J., Johnson, A.E.W., Clifford, G.D., Oster. J. (2014) <a href="http://www.ncbi.nlm.nih.gov/pubmed/24604619" data-toggle="tooltip" title="go to article" target="_blank">A comparison of single channel fetal ECG extraction methods.</a> <i>Annals of Biomed Eng</i>  <b>42(6)</b>, pp. 1340-1353.</td>
        </tr>
         <tr>
          <td><a id="Behar2014cinc">Behar2014cinc</a></td>
          <td>Behar, J., Oster, J., & Clifford, G. D. (2014). <a href="http://iopscience.iop.org/article/10.1088/0967-3334/35/8/1569" data-toggle="tooltip" title="go to article" target="_blank">Combining and Benchmarking Methods of Foetal ECG Extraction Without Maternal or Scalp Electrode Data.</a> <i>Physiol Meas</i>, <b>35(8)</b>, 1569–1589.</td>
        </tr>
        <tr>
          <td><a id="Behar2014model">Behar2014model</a></td>
          <td>Behar J., Andreotti F., Zaunseder S., Li Q., Oster J. and Clifford G D., 
        <a href="http://iopscience.iop.org/0967-3334/35/8/1537/article">An ECG model for 
            simulating maternal-foetal activity mixtures on abdominal ECG recordings.</a>
        <i>Physiol Meas</i> <b>35</b>, pp.1537-50, 2014.</td>
        </tr>
        <tr>
          <td><a id="Cerutti1986">Cerutti1986</a></td>
          <td>
        Cerutti, S., Baselli, G., Civardi, S., Ferrazzi, E., Marconi, A. M., Pagani, M., & Pardi, G. (1986).<a href="http://edoc.hu-berlin.de/oa/degruyter/jpme.1986.14.6.445.pdf" data-toggle="tooltip" title="go to article" target="_blank">Variability analysis of fetal heart rate signals as obtained from abdominal electrocardiographic recordings.</a> <i>J. Perinat. Med.</i>, 14(6), 445–452. <b>(Implementation by <a href="#Behar2014abme">Behar2014cinc</a>)</b></td>
        </tr>
        <tr>
          <td><a id="Martens2007">Martens2007</a></td>
          <td>
        Martens, S. M. M., Rabotti, C., Mischi, M., & Sluijter, R. J. (2007). <a href="http://dx.doi.org/10.1088/0967-3334/28/4/004" data-toggle="tooltip" title="go to article" target="_blank">A robust fetal ECG detection method for abdominal recordings.</a> <i>Physiol. Meas. </i>, 28(4), 373–388. <b>(Implementation by <a href="#Behar2014abme">Behar2014cinc</a>)</b></td>
        </tr>
       <tr>
          <td><a id="Jane1997">Jane1997</a></td>
          <td>Jane, R., Blasi, A., Garcia, J., & Laguna, P. (1997). <a href="http://doi.org/10.1109/CIC.1997.647889" data-toggle="tooltip" title="go to article" target="_blank">Evaluation of an automatic threshold based detector of waveform limits in Holter ECG with the QT database.</a> In Computers in Cardiology, pp. 295–298.</td>
        </tr>
          <tr>
          <td><a id="Kanjilal997">Kanjilal997</a></td>
          <td>Kanjilal, P. P., Palit, S., & Saha, G. (1997). <a href="http://doi.org/10.1109/10.553712" data-toggle="tooltip" title="go to article" target="_blank">Fetal ECG extraction from single-channel maternal ECG using singular value decomposition.</a> <i>IEEE Trans. Biomed. Eng.</i>, 44(1), 51–9. <b>(Implementation by <a href="#Behar2014abme">Behar2014cinc</a>)</b> </td>
        </tr>
        <tr>
          <td><a id="Oster2015">Oster2015</a></td>
          <td>Oster, J., Behar, J., Sayadi, O., Nemati, S., Johnson, A., & Clifford, G. (2015).<a href="http://doi.org/10.1109/TBME.2015.2402236" target="_blank" data-toggle="tooltip" title="go to article">Semi-supervised ECG Ventricular Beat Classification with Novelty Detection Based on Switching Kalman Filters.</a> <i>IEEE Trans. Biomed. Eng.</i>, <b>62(9)</b>, 2125–2134.</td>
        </tr>
        
        <tr>
          <td><a id="Sameni2008">Sameni2008</a></td>
          <td> Sameni, R. (2008). <a href="https://hal.archives-ouvertes.fr/tel-00373361/document" data-toggle="tooltip" title="go to article" target="_blank">Extraction of Fetal Cardiac Signals from an Array of Maternal
            Abdominal Recordings</a>, PhD thesis, Sharif University of Technology/Institut National Polytechnique de Grenoble. <b>(Implementation by <a href="#Andreotti2014">Andreotti2014</a> based on  <a href="#Sameni2010oset">Sameni2010oset</a> )</b></td>
        </tr>
    <tr>
        <tr>
          <td><a id="Sameni2010oset">Sameni2010oset</a></td>
          <td>Sameni, R. (2010). The Open-Source Electrophysiological Toolbox (OSET) v2.1. Retrieved from <a href="http://www.oset.ir" data-toggle="tooltip" title="go to article" target="_blank">http://www.oset.ir</a></td>
        </tr>
    <tr>
          <td><a id="Ungureanu2007">Ungureanu2007</a></td>
          <td>Ungureanu, M., Bergmans, J. W. M., Oei, S. G., & Strungaru, R. (2007). <a href="http://doi.org/10.1515/BMT.2007.011" data-toggle="tooltip" title="go to article" target="_blank">Fetal ECG extraction during labor using an adaptive maternal beat subtraction technique.</a> <i>Biomed. Tech.</i>, 52(1), 56–60. <b>(Implementation by <a href="#Behar2014abme">Behar2014cinc</a>)</b> </td>
        </tr>

<tr>
          <td><a id="Widrow1975">Widrow1975</a></td>
          <td>Widrow, B., Glover J.R., J., McCool, J. M., Kaunitz, J., Williams, C. S., Hearn, R H, Zeidler, J R, Eugene Dong,Jr. Goodlin, R C (1975). <a href="http://doi.org/10.1109/PROC.1975.10036" data-toggle="tooltip" title="go to article" target="_blank">Adaptive noise cancelling: Principles and applications.</a> Proceedings of the IEEE, 63(12), 1692–1716. <b>(Implementation by <a href="#Behar2014abme">Behar2014abme</a>)</b></td>
        </tr>

      </tbody>
    </table>
  </div>
</section>
